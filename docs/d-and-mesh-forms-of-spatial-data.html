<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 3D and mesh forms of spatial data | Computational graphics structures for geo-spatial data</title>
  <meta name="description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 3D and mesh forms of spatial data | Computational graphics structures for geo-spatial data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  <meta name="github-repo" content="mdsumner/geo-comp-graphics-oghub" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 3D and mesh forms of spatial data | Computational graphics structures for geo-spatial data" />
  
  <meta name="twitter:description" content="Converting geo-spatial data into meshes suitable for computational graphics systems." />
  

<meta name="author" content="Michael Sumner" />


<meta name="date" content="2019-09-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="getting-set-up.html"/>
<link rel="next" href="the-mesh3d-format.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.30/rglWebGL.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational graphics structures for geo-spatial data inR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#description-and-objectives"><i class="fa fa-check"></i><b>1.1</b> Description and objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-set-up.html"><a href="getting-set-up.html"><i class="fa fa-check"></i><b>2</b> Getting Set Up</a></li>
<li class="chapter" data-level="3" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html"><i class="fa fa-check"></i><b>3</b> 3D and mesh forms of spatial data</a><ul>
<li class="chapter" data-level="3.1" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#questions"><i class="fa fa-check"></i><b>3.1</b> Questions</a></li>
<li class="chapter" data-level="3.2" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#what-is-a-mesh"><i class="fa fa-check"></i><b>3.2</b> What is a mesh?</a></li>
<li class="chapter" data-level="3.3" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#geospatial-data"><i class="fa fa-check"></i><b>3.3</b> Geospatial data</a></li>
<li class="chapter" data-level="3.4" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#primitives"><i class="fa fa-check"></i><b>3.4</b> Primitives</a></li>
<li class="chapter" data-level="3.5" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#a-raster-is-a-mesh-implicitly"><i class="fa fa-check"></i><b>3.5</b> A raster is a mesh (implicitly)</a></li>
<li class="chapter" data-level="3.6" data-path="d-and-mesh-forms-of-spatial-data.html"><a href="d-and-mesh-forms-of-spatial-data.html#summary"><i class="fa fa-check"></i><b>3.6</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html"><i class="fa fa-check"></i><b>4</b> The mesh3d format</a><ul>
<li class="chapter" data-level="4.1" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#quads"><i class="fa fa-check"></i><b>4.1</b> Quads</a></li>
<li class="chapter" data-level="4.2" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#triangles"><i class="fa fa-check"></i><b>4.2</b> Triangles</a></li>
<li class="chapter" data-level="4.3" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#d-polygons"><i class="fa fa-check"></i><b>4.3</b> 3D polygons</a></li>
<li class="chapter" data-level="4.4" data-path="the-mesh3d-format.html"><a href="the-mesh3d-format.html#rgl-miscellanea"><i class="fa fa-check"></i><b>4.4</b> rgl miscellanea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html"><i class="fa fa-check"></i><b>5</b> Transforming spatial data to 3D forms</a><ul>
<li class="chapter" data-level="5.1" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#algorithms"><i class="fa fa-check"></i><b>5.1</b> Algorithms</a></li>
<li class="chapter" data-level="5.2" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#raster"><i class="fa fa-check"></i><b>5.2</b> raster</a></li>
<li class="chapter" data-level="5.3" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#vector"><i class="fa fa-check"></i><b>5.3</b> vector</a></li>
<li class="chapter" data-level="5.4" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#image-textures"><i class="fa fa-check"></i><b>5.4</b> Image textures</a></li>
<li class="chapter" data-level="5.5" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#triangles-or-quads-from-geospatial"><i class="fa fa-check"></i><b>5.5</b> Triangles or quads from geospatial</a></li>
<li class="chapter" data-level="5.6" data-path="transforming-spatial-data-to-3d-forms.html"><a href="transforming-spatial-data-to-3d-forms.html#various-other-3d-tools-in-r"><i class="fa fa-check"></i><b>5.6</b> Various other 3D tools in R</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html"><i class="fa fa-check"></i><b>6</b> Examples and exercises</a><ul>
<li class="chapter" data-level="6.1" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#exercise-1"><i class="fa fa-check"></i><b>6.1</b> Exercise 1</a><ul>
<li class="chapter" data-level="6.1.1" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#ex-1-answer"><i class="fa fa-check"></i><b>6.1.1</b> EX 1 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#exercise-2"><i class="fa fa-check"></i><b>6.2</b> Exercise 2</a><ul>
<li class="chapter" data-level="6.2.1" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#ex-2-answer"><i class="fa fa-check"></i><b>6.2.1</b> EX 2 ANSWER</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#exercise-3"><i class="fa fa-check"></i><b>6.3</b> Exercise 3</a></li>
<li class="chapter" data-level="6.4" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#quadmesh"><i class="fa fa-check"></i><b>6.4.1</b> Quadmesh</a></li>
<li class="chapter" data-level="6.4.2" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#polygon-triangulation"><i class="fa fa-check"></i><b>6.4.2</b> Polygon triangulation</a></li>
<li class="chapter" data-level="6.4.3" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#coordinate-systems-and-textures"><i class="fa fa-check"></i><b>6.4.3</b> Coordinate systems and textures</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="examples-and-exercises.html"><a href="examples-and-exercises.html#try-with-own-data"><i class="fa fa-check"></i><b>6.5</b> Try with own data</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/mdsumner/geo-comp-graphics-oghub" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational graphics structures for geo-spatial data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="d-and-mesh-forms-of-spatial-data" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> 3D and mesh forms of spatial data</h1>
<div id="questions" class="section level2">
<h2><span class="header-section-number">3.1</span> Questions</h2>
<ul>
<li>What are meshes and topology?<br />
</li>
<li>what is the relationship of meshes to geospatial raster/vector data?</li>
</ul>
</div>
<div id="what-is-a-mesh" class="section level2">
<h2><span class="header-section-number">3.2</span> What is a mesh?</h2>
<p>Key ideas!</p>
<ul>
<li><strong>Topology</strong>: the <em>shape</em> of things and their relationships.<br />
</li>
<li><strong>Geometry</strong>: the <em>where</em> of things.</li>
<li><strong>Indexing</strong>: the <em>link</em> between topology and geometry.</li>
</ul>
<p><em>Traditional spatial data tends to confuse topology and geometry.</em></p>
<p>These concepts motivate my interest in these ideas.</p>
<ul>
<li>Lossless reprojection</li>
<li>Topology fixes</li>
<li>Tracks and point clouds</li>
<li>Visualization</li>
</ul>
<p>Topology vs. geometry</p>
<p>This line has <strong>1-dimensional topology</strong> depicted in <strong>3-dimensional geometry</strong> and the triangle has <strong>2-dimensional topology</strong> depicted in <strong>3-dimensional geometry</strong>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#p3 &lt;- mfrow3d(1, 2, sharedMouse = TRUE)</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">(geometry &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dv">1</span>), <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.8</span>)))</a></code></pre></div>
<pre><code>##        x   y   z
## [1,] 0.0 0.0 0.0
## [2,] 0.5 0.5 0.0
## [3,] 1.0 1.0 0.8</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">(topology1 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">.v0 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">.v1 =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)))</a></code></pre></div>
<pre><code>##     [,1] [,2]
## .v0    1    2
## .v1    2    3</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">lines3d</span>(geometry[<span class="kw">t</span>(topology1), ], <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;firebrick&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">material3d</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">axis3d</span>(<span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="kw">axis3d</span>(<span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="kw">axis3d</span>(<span class="st">&quot;z&quot;</span>)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw">title3d</span>(<span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">zlab =</span> <span class="st">&quot;z&quot;</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="kw">quads3d</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span>), <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl73371" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl73371">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"7":{"id":7,"type":"linestrip","material":{"lit":false,"lwd":3},"vertices":[[0,0,0],[0.5,0.5,0],[0.5,0.5,0],[1,1,0.800000011920929]],"colors":[[0.69803923368454,0.133333340287209,0.133333340287209,1]],"centers":[[0,0,0],[0.5,0.5,0],[0.5,0.5,0],[1,1,0.800000011920929]],"ignoreExtent":false,"flags":16448},"8":{"id":8,"type":"lines","material":{"lit":false},"vertices":[[0,-0.0149999996647239,-0.0120000001043081],[1,-0.0149999996647239,-0.0120000001043081],[0,-0.0149999996647239,-0.0120000001043081],[0,-0.0407500006258488,-0.032600000500679],[0.200000002980232,-0.0149999996647239,-0.0120000001043081],[0.200000002980232,-0.0407500006258488,-0.032600000500679],[0.400000005960464,-0.0149999996647239,-0.0120000001043081],[0.400000005960464,-0.0407500006258488,-0.032600000500679],[0.600000023841858,-0.0149999996647239,-0.0120000001043081],[0.600000023841858,-0.0407500006258488,-0.032600000500679],[0.800000011920929,-0.0149999996647239,-0.0120000001043081],[0.800000011920929,-0.0407500006258488,-0.032600000500679],[1,-0.0149999996647239,-0.0120000001043081],[1,-0.0407500006258488,-0.032600000500679]],"colors":[[0,0,0,1]],"centers":[[0.5,-0.0149999996647239,-0.0120000001043081],[0,-0.0278750006109476,-0.0223000012338161],[0.200000002980232,-0.0278750006109476,-0.0223000012338161],[0.400000005960464,-0.0278750006109476,-0.0223000012338161],[0.600000023841858,-0.0278750006109476,-0.0223000012338161],[0.800000011920929,-0.0278750006109476,-0.0223000012338161],[1,-0.0278750006109476,-0.0223000012338161]],"ignoreExtent":true,"flags":64},"9":{"id":9,"type":"text","material":{"lit":false},"vertices":[[0,-0.0922499969601631,-0.0737999975681305],[0.200000002980232,-0.0922499969601631,-0.0737999975681305],[0.400000005960464,-0.0922499969601631,-0.0737999975681305],[0.600000023841858,-0.0922499969601631,-0.0737999975681305],[0.800000011920929,-0.0922499969601631,-0.0737999975681305],[1,-0.0922499969601631,-0.0737999975681305]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"],["1.0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0,-0.0922499969601631,-0.0737999975681305],[0.200000002980232,-0.0922499969601631,-0.0737999975681305],[0.400000005960464,-0.0922499969601631,-0.0737999975681305],[0.600000023841858,-0.0922499969601631,-0.0737999975681305],[0.800000011920929,-0.0922499969601631,-0.0737999975681305],[1,-0.0922499969601631,-0.0737999975681305]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"10":{"id":10,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,0,-0.0120000001043081],[-0.0149999996647239,1,-0.0120000001043081],[-0.0149999996647239,0,-0.0120000001043081],[-0.0407500006258488,0,-0.032600000500679],[-0.0149999996647239,0.200000002980232,-0.0120000001043081],[-0.0407500006258488,0.200000002980232,-0.032600000500679],[-0.0149999996647239,0.400000005960464,-0.0120000001043081],[-0.0407500006258488,0.400000005960464,-0.032600000500679],[-0.0149999996647239,0.600000023841858,-0.0120000001043081],[-0.0407500006258488,0.600000023841858,-0.032600000500679],[-0.0149999996647239,0.800000011920929,-0.0120000001043081],[-0.0407500006258488,0.800000011920929,-0.032600000500679],[-0.0149999996647239,1,-0.0120000001043081],[-0.0407500006258488,1,-0.032600000500679]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,0.5,-0.0120000001043081],[-0.0278750006109476,0,-0.0223000012338161],[-0.0278750006109476,0.200000002980232,-0.0223000012338161],[-0.0278750006109476,0.400000005960464,-0.0223000012338161],[-0.0278750006109476,0.600000023841858,-0.0223000012338161],[-0.0278750006109476,0.800000011920929,-0.0223000012338161],[-0.0278750006109476,1,-0.0223000012338161]],"ignoreExtent":true,"flags":64},"11":{"id":11,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,0,-0.0737999975681305],[-0.0922499969601631,0.200000002980232,-0.0737999975681305],[-0.0922499969601631,0.400000005960464,-0.0737999975681305],[-0.0922499969601631,0.600000023841858,-0.0737999975681305],[-0.0922499969601631,0.800000011920929,-0.0737999975681305],[-0.0922499969601631,1,-0.0737999975681305]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"],["1.0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,0,-0.0737999975681305],[-0.0922499969601631,0.200000002980232,-0.0737999975681305],[-0.0922499969601631,0.400000005960464,-0.0737999975681305],[-0.0922499969601631,0.600000023841858,-0.0737999975681305],[-0.0922499969601631,0.800000011920929,-0.0737999975681305],[-0.0922499969601631,1,-0.0737999975681305]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"12":{"id":12,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,-0.0149999996647239,0],[-0.0149999996647239,-0.0149999996647239,0.800000011920929],[-0.0149999996647239,-0.0149999996647239,0],[-0.0407500006258488,-0.0407500006258488,0],[-0.0149999996647239,-0.0149999996647239,0.200000002980232],[-0.0407500006258488,-0.0407500006258488,0.200000002980232],[-0.0149999996647239,-0.0149999996647239,0.400000005960464],[-0.0407500006258488,-0.0407500006258488,0.400000005960464],[-0.0149999996647239,-0.0149999996647239,0.600000023841858],[-0.0407500006258488,-0.0407500006258488,0.600000023841858],[-0.0149999996647239,-0.0149999996647239,0.800000011920929],[-0.0407500006258488,-0.0407500006258488,0.800000011920929]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,-0.0149999996647239,0.400000005960464],[-0.0278750006109476,-0.0278750006109476,0],[-0.0278750006109476,-0.0278750006109476,0.200000002980232],[-0.0278750006109476,-0.0278750006109476,0.400000005960464],[-0.0278750006109476,-0.0278750006109476,0.600000023841858],[-0.0278750006109476,-0.0278750006109476,0.800000011920929]],"ignoreExtent":true,"flags":64},"13":{"id":13,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"14":{"id":14,"type":"text","material":{"lit":false},"vertices":[[0.5,-0.16949999332428,-0.135600000619888]],"colors":[[0,0,0,1]],"texts":[["x"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.5,-0.16949999332428,-0.135600000619888]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"15":{"id":15,"type":"text","material":{"lit":false},"vertices":[[-0.16949999332428,0.5,-0.135600000619888]],"colors":[[0,0,0,1]],"texts":[["y"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,0.5,-0.135600000619888]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"16":{"id":16,"type":"text","material":{"lit":false},"vertices":[[-0.16949999332428,-0.16949999332428,0.400000005960464]],"colors":[[0,0,0,1]],"texts":[["z"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,-0.16949999332428,0.400000005960464]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"17":{"id":17,"type":"quads","material":{},"vertices":[[0,0,-0.00999999977648258],[1,0,-0.00999999977648258],[1,1,-0.00999999977648258],[0,1,-0.00999999977648258]],"normals":[[0,-0,1],[0,-0,1],[0,-0,1],[0,-0,1]],"colors":[[0.745098054409027,0.745098054409027,0.745098054409027,1]],"centers":[[0.5,0.5,-0.00999999977648258]],"ignoreExtent":false,"flags":3},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{"fog":true},"colors":[[0.298039227724075,0.298039227724075,0.298039227724075,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.14844393730164],"modelMatrix":[[1,0,0,-0.5],[0,0.342020153999329,0.939692616462708,-0.54218864440918],[0,-0.939692616462708,0.342020153999329,-2.81369566917419],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370325088501,-11.3497762680054],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1,0,1,-0.00999999977648258,0.800000011920929],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,7,8,9,10,11,12,13,14,15,16,17,5],"subscenes":[],"flags":19027},"24":{"id":24,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":24,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143208,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143208,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186547,-0.555570233019602,-0.38268343236509,-0.195090322016128,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186547,0.831469612302545,0.923879532511287,0.98078528040323,1],[0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.137949689641472,0.270598050073099,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186548,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073099,0.137949689641472,0,0,0.0746578340503426,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503426,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.0746578340503426,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143208,-0.353553390593274,-0.375330277517865,-0.38268343236509,-0.375330277517865,-0.353553390593274,-0.318189645143208,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503426,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.587937801209679,-0.653281482438188,-0.693519922661074,-0.707106781186547,-0.693519922661074,-0.653281482438188,-0.587937801209679,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.195090322016128,-0.38268343236509,-0.555570233019602,-0.707106781186548,-0.831469612302545,-0.923879532511287,-0.98078528040323,-1,-0.98078528040323,-0.923879532511287,-0.831469612302545,-0.707106781186548,-0.555570233019602,-0.38268343236509,-0.195090322016128,-0,-0,-0.180239955501737,-0.353553390593274,-0.513279967159337,-0.653281482438188,-0.768177756711416,-0.853553390593274,-0.906127446352888,-0.923879532511287,-0.906127446352888,-0.853553390593274,-0.768177756711416,-0.653281482438188,-0.513279967159337,-0.353553390593274,-0.180239955501737,-0,-0,-0.137949689641472,-0.270598050073099,-0.392847479193551,-0.5,-0.58793780120968,-0.653281482438188,-0.693519922661074,-0.707106781186548,-0.693519922661074,-0.653281482438188,-0.58793780120968,-0.5,-0.392847479193551,-0.270598050073099,-0.137949689641472,-0,-0,-0.0746578340503427,-0.146446609406726,-0.212607523691814,-0.270598050073099,-0.318189645143209,-0.353553390593274,-0.375330277517866,-0.38268343236509,-0.375330277517866,-0.353553390593274,-0.318189645143209,-0.270598050073099,-0.212607523691814,-0.146446609406726,-0.0746578340503427,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0746578340503427,0.146446609406726,0.212607523691814,0.270598050073099,0.318189645143209,0.353553390593274,0.375330277517865,0.38268343236509,0.375330277517865,0.353553390593274,0.318189645143209,0.270598050073099,0.212607523691814,0.146446609406726,0.0746578340503427,0,0,0.137949689641472,0.270598050073098,0.392847479193551,0.5,0.587937801209679,0.653281482438188,0.693519922661074,0.707106781186547,0.693519922661074,0.653281482438188,0.587937801209679,0.5,0.392847479193551,0.270598050073098,0.137949689641472,0,0,0.180239955501737,0.353553390593274,0.513279967159337,0.653281482438188,0.768177756711416,0.853553390593274,0.906127446352888,0.923879532511287,0.906127446352888,0.853553390593274,0.768177756711416,0.653281482438188,0.513279967159337,0.353553390593274,0.180239955501737,0,0,0.195090322016128,0.38268343236509,0.555570233019602,0.707106781186548,0.831469612302545,0.923879532511287,0.98078528040323,1,0.98078528040323,0.923879532511287,0.831469612302545,0.707106781186548,0.555570233019602,0.38268343236509,0.195090322016128,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co">#next3d()</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">clear3d</span>()</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">(topology2 &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">.v0 =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>), <span class="dt">.v1 =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>)))</a></code></pre></div>
<pre><code>##     [,1] [,2] [,3]
## .v0    1    2    1
## .v1    2    3    1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">triangles3d</span>(geometry[<span class="kw">t</span>(topology2), ], <span class="dt">col =</span> <span class="st">&quot;firebrick&quot;</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">material3d</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">axis3d</span>(<span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">axis3d</span>(<span class="st">&quot;y&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="kw">axis3d</span>(<span class="st">&quot;z&quot;</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="kw">title3d</span>(<span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">zlab =</span> <span class="st">&quot;z&quot;</span>)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="kw">quads3d</span>(<span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)), <span class="dt">col=</span><span class="st">&quot;gray&quot;</span>)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="kw">rglwidget</span>()</a></code></pre></div>
<div id="rgl2655" style="width:672px;height:480px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl2655">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"25":{"id":25,"type":"triangles","material":{},"vertices":[[0,0,0],[0.5,0.5,0],[0,0,0],[0.5,0.5,0],[1,1,0.800000011920929],[0,0,0]],"normals":[[0,0,0],[0,0,0],[0,0,0],[0.70710676908493,-0.70710676908493,0],[0.70710676908493,-0.70710676908493,0],[0.70710676908493,-0.70710676908493,0]],"colors":[[0.69803923368454,0.133333340287209,0.133333340287209,1]],"centers":[[0.16666667163372,0.16666667163372,0],[0.5,0.5,0.266666680574417]],"ignoreExtent":false,"flags":3},"26":{"id":26,"type":"lines","material":{"lit":false},"vertices":[[0,-0.0149999996647239,-0.0120000001043081],[1,-0.0149999996647239,-0.0120000001043081],[0,-0.0149999996647239,-0.0120000001043081],[0,-0.0407500006258488,-0.032600000500679],[0.200000002980232,-0.0149999996647239,-0.0120000001043081],[0.200000002980232,-0.0407500006258488,-0.032600000500679],[0.400000005960464,-0.0149999996647239,-0.0120000001043081],[0.400000005960464,-0.0407500006258488,-0.032600000500679],[0.600000023841858,-0.0149999996647239,-0.0120000001043081],[0.600000023841858,-0.0407500006258488,-0.032600000500679],[0.800000011920929,-0.0149999996647239,-0.0120000001043081],[0.800000011920929,-0.0407500006258488,-0.032600000500679],[1,-0.0149999996647239,-0.0120000001043081],[1,-0.0407500006258488,-0.032600000500679]],"colors":[[0,0,0,1]],"centers":[[0.5,-0.0149999996647239,-0.0120000001043081],[0,-0.0278750006109476,-0.0223000012338161],[0.200000002980232,-0.0278750006109476,-0.0223000012338161],[0.400000005960464,-0.0278750006109476,-0.0223000012338161],[0.600000023841858,-0.0278750006109476,-0.0223000012338161],[0.800000011920929,-0.0278750006109476,-0.0223000012338161],[1,-0.0278750006109476,-0.0223000012338161]],"ignoreExtent":true,"flags":64},"27":{"id":27,"type":"text","material":{"lit":false},"vertices":[[0,-0.0922499969601631,-0.0737999975681305],[0.200000002980232,-0.0922499969601631,-0.0737999975681305],[0.400000005960464,-0.0922499969601631,-0.0737999975681305],[0.600000023841858,-0.0922499969601631,-0.0737999975681305],[0.800000011920929,-0.0922499969601631,-0.0737999975681305],[1,-0.0922499969601631,-0.0737999975681305]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"],["1.0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0,-0.0922499969601631,-0.0737999975681305],[0.200000002980232,-0.0922499969601631,-0.0737999975681305],[0.400000005960464,-0.0922499969601631,-0.0737999975681305],[0.600000023841858,-0.0922499969601631,-0.0737999975681305],[0.800000011920929,-0.0922499969601631,-0.0737999975681305],[1,-0.0922499969601631,-0.0737999975681305]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"28":{"id":28,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,0,-0.0120000001043081],[-0.0149999996647239,1,-0.0120000001043081],[-0.0149999996647239,0,-0.0120000001043081],[-0.0407500006258488,0,-0.032600000500679],[-0.0149999996647239,0.200000002980232,-0.0120000001043081],[-0.0407500006258488,0.200000002980232,-0.032600000500679],[-0.0149999996647239,0.400000005960464,-0.0120000001043081],[-0.0407500006258488,0.400000005960464,-0.032600000500679],[-0.0149999996647239,0.600000023841858,-0.0120000001043081],[-0.0407500006258488,0.600000023841858,-0.032600000500679],[-0.0149999996647239,0.800000011920929,-0.0120000001043081],[-0.0407500006258488,0.800000011920929,-0.032600000500679],[-0.0149999996647239,1,-0.0120000001043081],[-0.0407500006258488,1,-0.032600000500679]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,0.5,-0.0120000001043081],[-0.0278750006109476,0,-0.0223000012338161],[-0.0278750006109476,0.200000002980232,-0.0223000012338161],[-0.0278750006109476,0.400000005960464,-0.0223000012338161],[-0.0278750006109476,0.600000023841858,-0.0223000012338161],[-0.0278750006109476,0.800000011920929,-0.0223000012338161],[-0.0278750006109476,1,-0.0223000012338161]],"ignoreExtent":true,"flags":64},"29":{"id":29,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,0,-0.0737999975681305],[-0.0922499969601631,0.200000002980232,-0.0737999975681305],[-0.0922499969601631,0.400000005960464,-0.0737999975681305],[-0.0922499969601631,0.600000023841858,-0.0737999975681305],[-0.0922499969601631,0.800000011920929,-0.0737999975681305],[-0.0922499969601631,1,-0.0737999975681305]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"],["1.0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,0,-0.0737999975681305],[-0.0922499969601631,0.200000002980232,-0.0737999975681305],[-0.0922499969601631,0.400000005960464,-0.0737999975681305],[-0.0922499969601631,0.600000023841858,-0.0737999975681305],[-0.0922499969601631,0.800000011920929,-0.0737999975681305],[-0.0922499969601631,1,-0.0737999975681305]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"30":{"id":30,"type":"lines","material":{"lit":false},"vertices":[[-0.0149999996647239,-0.0149999996647239,0],[-0.0149999996647239,-0.0149999996647239,0.800000011920929],[-0.0149999996647239,-0.0149999996647239,0],[-0.0407500006258488,-0.0407500006258488,0],[-0.0149999996647239,-0.0149999996647239,0.200000002980232],[-0.0407500006258488,-0.0407500006258488,0.200000002980232],[-0.0149999996647239,-0.0149999996647239,0.400000005960464],[-0.0407500006258488,-0.0407500006258488,0.400000005960464],[-0.0149999996647239,-0.0149999996647239,0.600000023841858],[-0.0407500006258488,-0.0407500006258488,0.600000023841858],[-0.0149999996647239,-0.0149999996647239,0.800000011920929],[-0.0407500006258488,-0.0407500006258488,0.800000011920929]],"colors":[[0,0,0,1]],"centers":[[-0.0149999996647239,-0.0149999996647239,0.400000005960464],[-0.0278750006109476,-0.0278750006109476,0],[-0.0278750006109476,-0.0278750006109476,0.200000002980232],[-0.0278750006109476,-0.0278750006109476,0.400000005960464],[-0.0278750006109476,-0.0278750006109476,0.600000023841858],[-0.0278750006109476,-0.0278750006109476,0.800000011920929]],"ignoreExtent":true,"flags":64},"31":{"id":31,"type":"text","material":{"lit":false},"vertices":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929]],"colors":[[0,0,0,1]],"texts":[["0.0"],["0.2"],["0.4"],["0.6"],["0.8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.0922499969601631,-0.0922499969601631,0],[-0.0922499969601631,-0.0922499969601631,0.200000002980232],[-0.0922499969601631,-0.0922499969601631,0.400000005960464],[-0.0922499969601631,-0.0922499969601631,0.600000023841858],[-0.0922499969601631,-0.0922499969601631,0.800000011920929]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"32":{"id":32,"type":"text","material":{"lit":false},"vertices":[[0.5,-0.16949999332428,-0.135600000619888]],"colors":[[0,0,0,1]],"texts":[["x"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.5,-0.16949999332428,-0.135600000619888]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"33":{"id":33,"type":"text","material":{"lit":false},"vertices":[[-0.16949999332428,0.5,-0.135600000619888]],"colors":[[0,0,0,1]],"texts":[["y"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,0.5,-0.135600000619888]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"34":{"id":34,"type":"text","material":{"lit":false},"vertices":[[-0.16949999332428,-0.16949999332428,0.400000005960464]],"colors":[[0,0,0,1]],"texts":[["z"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.16949999332428,-0.16949999332428,0.400000005960464]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"35":{"id":35,"type":"quads","material":{},"vertices":[[0,0,0],[1,0,0],[1,1,0],[0,1,0]],"normals":[[0,-0,1],[0,-0,1],[0,-0,1],[0,-0,1]],"colors":[[0.745098054409027,0.745098054409027,0.745098054409027,1]],"centers":[[0.5,0.5,0]],"ignoreExtent":false,"flags":3},"5":{"id":5,"reuse":"rgl73371"},"4":{"id":4,"reuse":"rgl73371"},"6":{"id":6,"reuse":"rgl73371"},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.13888740539551],"modelMatrix":[[1,0,0,-0.5],[0,0.342020153999329,0.939692616462708,-0.546887159347534],[0,-0.939692616462708,0.342020153999329,-2.80584907531738],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370348930359,-11.3153257369995],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[0,1,0,1,0,0.800000011920929],"windowRect":[0,0,256,256],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,25,26,27,28,29,30,31,32,33,34,35,5],"subscenes":[],"flags":2643},"42":{"id":42,"type":"linestrip","material":{"alpha":0.498039215803146,"lit":false,"depth_test":"always","isTransparent":true},"vertices":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"colors":[[0,0,0,0.498039215803146]],"centers":[[0,0,-0.999000012874603],[1,0,-0.999000012874603],[1,1,-0.999000012874603],[0,1,-0.999000012874603],[0,0,-0.999000012874603]],"ignoreExtent":false,"flags":32864}},"crosstalk":{"key":[null],"group":"","id":0,"options":[null]},"width":672,"height":480,"brushId":42,"sphereVerts":{"reuse":"rgl73371"},"context":{"shiny":false,"rmarkdown":"bookdown::gitbook"},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">clear3d</span>()</a></code></pre></div>
</div>
<div id="geospatial-data" class="section level2">
<h2><span class="header-section-number">3.3</span> Geospatial data</h2>
<ul>
<li>raster</li>
<li>vector</li>
</ul>
<p>These are traditionally kept separate, but in computer graphics the distinction starts to disappear.</p>
<p>What is a raster?</p>
<p>A layer of neighbouring rectangles?</p>
<p><img src="geo-comp-graphics_files/figure-html/what-raster-1.png" width="672" /></p>
<p>Or a continuous fields between points?</p>
<p>(Lots of ways to infer the field, including this very poor one).</p>
<p><img src="geo-comp-graphics_files/figure-html/what-raster-2-1.png" width="672" /></p>
<p>What is a polygon?</p>
<p>A series of grouped <em>paths</em>?</p>
<p><img src="geo-comp-graphics_files/figure-html/what-polygon-1.png" width="672" /></p>
<p>What’s in the middle?</p>
<pre><code>## Warning in st_centroid.sf(tri): st_centroid assumes attributes are constant
## over geometries of x</code></pre>
<p><img src="geo-comp-graphics_files/figure-html/what-middle-1.png" width="672" /></p>
<p>The <em>fill</em> we see in traditional 2D graphics is a <strong>trick!!</strong>.</p>
<p>Search:</p>
<blockquote>
<p>it’s not what you draw it’s what you not draw ~Paul Murrell</p>
</blockquote>
<p>Technically the trick comes in two types, either the <em>even-odd</em> or <em>winding</em> rule, and this trick is not part of this workshop. The graphics engine uses this rule to draw a pixel if it has been encircled an even or odd number of times, or using a rule about in which direction it was encircled. It happens deep in the graphics.</p>
<p>Where it does matter is for the concept of <em>orientation</em>, and 3D graphics do care about the direction that triangles are wound (consider that reversing the direction is like flipping the triangle in place in terms of how some algorithms behave …).</p>
<p>What’s the fill?</p>
<p>In 3D, and to fill our polygons properly <em>as data</em> - we need <strong>primitives</strong>.</p>
</div>
<div id="primitives" class="section level2">
<h2><span class="header-section-number">3.4</span> Primitives</h2>
<p>Terminology alert! (This is my <em>working definition</em> of primitive for this topic, not everyone agrees.)</p>
<ul>
<li>Point - a single coordinate is a 0-dimensional primitive (vertex, coordinate)</li>
<li>Line - a line segment between two coordinates is a 1-dimensional primitive (edge, segment)</li>
<li>Triangle - a triangle joining three coordinates is 2-dimensional primitive</li>
<li>Quad - a four-sided shape (not as core-primitive as a triangle, but commonly used)</li>
</ul>
<p><em>Topology is not geometry</em></p>
<p>(This is <em>topological</em> dimension. Every one of these types of shape can be depicted within a geometric space that is equal to or higher than the topological dimension.)</p>
<p>We will have a matrix of vertices and a matrix of primitive indices. Quads and triangles are generally called <em>faces</em>, line segments are alternatively called <em>edges</em>. All are primitives in computer graphics, but we’ll also see the term <em>finite element</em> used.</p>
<p>Topology can be 3D (tetrahedron) - imagine volumetric fill versus planar faces bounding a volume. Geometry can be 4D, X, Y, Z, T - or any dimensionality we need.</p>
<p>To fill our polygon we need triangles.</p>
<pre><code>## Warning in st_cast.sf(sfdct::ct_triangulate(minimal_mesh, a = 0.01, D =
## TRUE)): repeating attributes for all sub-geometries for which they may not
## be constant</code></pre>
<p><img src="geo-comp-graphics_files/figure-html/triangles-1-1.png" width="672" /></p>
<p>Note that if we turn off the border, we don’t notice the difference.</p>
<p><img src="geo-comp-graphics_files/figure-html/triangles-2-1.png" width="672" /></p>
<p>No tricky winding or even-odd rule to worry about, but we have lost our boundary around each distinct shape - we could find them by finding edges within a shape that are not shared by two triangles …</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">plot</span>(tri, <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## Warning in plot.sf(tri, border = NA, col = rainbow(10)): col is not of
## length 1 or nrow(x): colors will be recycled; use pal to specify a color
## palette</code></pre>
<p><img src="geo-comp-graphics_files/figure-html/triangles-3-1.png" width="672" /></p>
<p>Raster and vector are not a strong distinction when it comes to meshes</p>
<p>A raster is a very simple version of a mesh. When we store a raster we need the equivalent of</p>
<ul>
<li>number of columns and rows</li>
<li>the extent in the coordinate system used (xmin, xmax, ymin, ymax)</li>
<li>the coordinate system</li>
<li>the cell values! (ncols * nrows of them)</li>
</ul>
<p>In in computer graphics we store</p>
<ul>
<li>the corner coordinates ((ncols + 1) * (nrows + 1) of them)</li>
<li>an index, 4 indices for every quad specify the coordinates</li>
<li>groupings (or at least <em>material-properties</em>), what quads belong to which objects</li>
<li>the coordinate system (hopefully)</li>
</ul>
<p>It’s the same for a triangular mesh.</p>
<ul>
<li>the corner coordinates</li>
<li>an index, 3 indices for every triangle</li>
<li>groupings, what triangles belong to which objects</li>
<li>the coordinate system (hopefully)</li>
</ul>
<p>And lines are</p>
<ul>
<li>the end point coordinates of each line segment (or edge)</li>
<li>an index, 2 indices for every segment</li>
<li>groupings, what line segments belong to which objects (features)</li>
<li>the coordinate system (hopefully)</li>
</ul>
</div>
<div id="a-raster-is-a-mesh-implicitly" class="section level2">
<h2><span class="header-section-number">3.5</span> A raster is a mesh (implicitly)</h2>
<p>The simplest kind of mesh is a basic raster. Consider the matrix from above.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="dt">length =</span> <span class="dv">5</span>), </a>
<a class="sourceLine" id="cb18-2" data-line-number="2">            <span class="kw">seq</span>(<span class="fl">0.375</span>, <span class="dv">0</span>, <span class="dt">length =</span> <span class="dv">4</span>)), <span class="dv">3</span>)</a></code></pre></div>
<p>On its own this matrix has absolutely nothing to do with spatial data, it is literally a collection of 9 numeric values in a given order, and by the magic of programming we’ve nominated a shape of 3x3. We can’t help but think about this shape spatially however, but there’s a problem. Does each element occupy space or should we consider them to be infinitesimal locations?</p>
<p>R provides either interpretation (to simplify this story we nominate locations for the rows and columns explicitly).</p>
<p>When considered as an image, each matrix element occupies a certain space in width and height, but when considered as a point set the numbers simply float at the given locations. Which is correct? (Spoiler: Both are correct, it simply depends what we are doing.)</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(m)) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">ncol</span>(m)) <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="kw">image</span>(x, y, m, <span class="dt">col =</span> <span class="kw">colpal</span>())</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="kw">text</span>(<span class="kw">expand.grid</span>(x, y), <span class="dt">lab =</span> m[])</a></code></pre></div>
<p><img src="geo-comp-graphics_files/figure-html/raw-base-image-1.png" width="672" /></p>
<p>The raster package defaults to the image interpretation and helpfully assumes the values are nominally at the centre points as shown above. We have to nominate the extent or we end up in 0,1 range, we also have to invert the order of the values because raster counts from the top of the page and R’s matrix uses <a href="https://CRAN.R-project.org/package=reticulate/vignettes/arrays.html">column-major order</a>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">(r &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="kw">t</span>(m[, <span class="kw">ncol</span>(m)<span class="op">:</span><span class="dv">1</span>]), <span class="dt">xmn =</span> <span class="dv">0</span>, <span class="dt">xmx =</span><span class="kw">ncol</span>(m), <span class="dt">ymn =</span> <span class="dv">0</span>, <span class="dt">ymx =</span> <span class="kw">nrow</span>(m)))</a></code></pre></div>
<pre><code>## class      : RasterLayer 
## dimensions : 3, 3, 9  (nrow, ncol, ncell)
## resolution : 1, 1  (x, y)
## extent     : 0, 3, 0, 3  (xmin, xmax, ymin, ymax)
## crs        : NA 
## source     : memory
## names      : layer 
## values     : 0, 0.5  (min, max)</code></pre>
<p>R’s image and rasters in general are so efficient because they only store this minimal amount of information: the actual data values, and the extent and dimensions of the space they occur in. If we had to store the centre coordinate of every cell, or worse the corner coordinates then the data storage goes up dramatically. Every software that deals well with these kinds of data has to treat these coordinates as implicit. We can easily expand the centre coordinates.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">xyz &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(r, <span class="dt">xy =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw">head</span>(xyz)</a></code></pre></div>
<pre><code>##     x   y layer
## 1 0.5 2.5 0.250
## 2 1.5 2.5 0.125
## 3 2.5 2.5 0.000
## 4 0.5 1.5 0.375
## 5 1.5 1.5 0.500
## 6 2.5 1.5 0.375</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">tail</span>(xyz)</a></code></pre></div>
<pre><code>##     x   y layer
## 4 0.5 1.5 0.375
## 5 1.5 1.5 0.500
## 6 2.5 1.5 0.375
## 7 0.5 0.5 0.000
## 8 1.5 0.5 0.125
## 9 2.5 0.5 0.250</code></pre>
<p>but to expand the corners we have to jump through some hoops and even then we get <em>every instance</em> of the corners, not only for each cell but to explicitly close the cell as a polygon.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">as</span>(<span class="kw">as</span>(raster<span class="op">::</span><span class="kw">rasterToPolygons</span>(r), <span class="st">&quot;SpatialLinesDataFrame&quot;</span>), </a>
<a class="sourceLine" id="cb26-2" data-line-number="2">   <span class="st">&quot;SpatialPointsDataFrame&quot;</span>)</a></code></pre></div>
<pre><code>## class       : SpatialPointsDataFrame 
## features    : 45 
## extent      : 0, 3, 0, 3  (xmin, xmax, ymin, ymax)
## crs         : NA 
## variables   : 4
## names       : layer, Lines.NR, Lines.ID, Line.NR 
## min values  :     0,        1,        1,       1 
## max values  :   0.5,        9,        9,       1</code></pre>
<p>The polygon version of the raster, converted to points has <em>45 coordinates</em> in it, although there are only 16 unique coordinates at the corners, which is where <code>mesh3d</code> comes in.</p>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">3.6</span> Summary</h2>
<ul>
<li>Topology and geometry are independently <em>dimensional</em></li>
<li>Meshes include a matrix of vertices and a matrix of indices</li>
<li>In mesh-terms rasters and polygons aren’t so different</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="getting-set-up.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-mesh3d-format.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mdsumner/geo-comp-graphics-oghub/edit/master/02_overview_mesh.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
